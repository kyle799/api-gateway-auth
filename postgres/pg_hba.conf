# PostgreSQL Client Authentication Configuration
#
# STIG-Hardened: Only allow encrypted password authentication
# Reference: PostgreSQL 9.x STIG

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections - require password
local   all             all                                     scram-sha-256

# IPv4 local connections - require password
host    all             all             127.0.0.1/32            scram-sha-256

# Docker network connections - require password
# Adjust this CIDR to match your Docker network
host    all             all             172.16.0.0/12           scram-sha-256
host    all             all             192.168.0.0/16          scram-sha-256
host    all             all             10.0.0.0/8              scram-sha-256

# Deny all other connections by default
# (implicit deny - PostgreSQL rejects if no rule matches)

# ===========================================
# SSL-Required Connections (enable when SSL configured)
# ===========================================
# Uncomment below and comment above 'host' lines to require SSL
#
# hostssl all           all             172.16.0.0/12           scram-sha-256
# hostssl all           all             192.168.0.0/16          scram-sha-256
# hostssl all           all             10.0.0.0/8              scram-sha-256
